---
title: "Effects of infrastructures for peace"
author: "Maria Benavides"
output: github_document
---


```{r setup, include = FALSE}
library(tidyverse)
library(readxl)
library(here)
```


```{r import data, include = FALSE}

# Import FSI downloaded from the website 
fsi_all <- read_excel(here("data/fsi-2006.xlsx"))

for (i in 2007:2020) {           # Use for loop to import all files at once
  fsi_year <- read_excel(here(
    paste(
      "data/fsi-", i, ".xlsx", sep = "")
    )
  )
  if (i %in% c(2019,2020)) {
    fsi_year <- select(fsi_year, -"Change from Previous Year") # Drop extra column for 2019 and 2020
  }
  fsi_all <- rbind(fsi_all, fsi_year) # Combine all data frames into one
}

fsi_all$Year <- as.numeric(str_extract(fsi_all$Year, "[0-9]{4}")) # Modify year variable since it was on a date format 

# Import GPI also downloaded from the website 
gpi_all <- read_xlsx("data/GPI_all.xlsx", sheet = "Overall Scores", skip = 3)

```

## Introduction 

Achieving sustainable peace is one of the most relevant global issues today, especially, since high levels of conflict and violence appeared to be correlated with stagnant development; however, managing to transform violent conflict into stable, nonviolent social and political relationships is a great challenge. 

Recently, a new tool for peacebuilding has caught the attention of scholars and practitioners: *Infrastructures for Peace* (I4P). These can be understood as a dynamic network of skills, capacities, resources, tools and institutions that help build constructive relationships and enhance sustainable resilience of societies against the risks of relapse into violence (Giessmann, 2016).

Considering the above, on this report, I will explore the variations on some positive and negative peace indicators (Fragile State Index and Global Peace Index), on seven countries that have developed government-lead, national peace infrastructures. 

The countries are: 

* Afghanistan
* Cambodia
* Colombia
* Costa Rica
* Ghana
* Kenya
* Yemen

```{r data viz fsi, echo=FALSE}

# Plot a graph of the trends of FSI 

fsi_selection <- fsi_all %>%
  select(1,2,4) %>% # Select variables of interest
  filter(
      Country == "Colombia" |
      Country == "Afghanistan" |
      Country == "Cambodia" |
      Country == "Costa Rica" |
      Country == "Ghana" |
      Country == "Kenya" |
      Country == "Yemen" 
    ) %>%
    pivot_wider(
      id_cols = Country,
      names_from = Year, 
      values_from = Total
    )  %>%
    mutate( # Create new normalized variable to compare
      "2006_2" = 100, 
      "2007_2" = 100 + ((`2007` - `2006`)/`2006`), 
      "2008_2" = 100 + ((`2008` - `2006`)/`2006`), 
      "2009_2" = 100 + ((`2009` - `2006`)/`2006`), 
      "2010_2" = 100 + ((`2010` - `2006`)/`2006`), 
      "2011_2" = 100 + ((`2011` - `2006`)/`2006`),
      "2012_2" = 100 + ((`2012` - `2006`)/`2006`), 
      "2013_2" = 100 + ((`2013` - `2006`)/`2006`), 
      "2014_2" = 100 + ((`2014` - `2006`)/`2006`), 
      "2015_2" = 100 + ((`2015` - `2006`)/`2006`), 
      "2016_2" = 100 + ((`2016` - `2006`)/`2006`), 
      "2017_2" = 100 + ((`2017` - `2006`)/`2006`), 
      "2018_2" = 100 + ((`2018` - `2006`)/`2006`), 
      "2019_2" = 100 + ((`2019` - `2006`)/`2006`),
      "2020_2" = 100 + ((`2020` - `2006`)/`2006`)
    ) %>%
  select(
    1, 17:31
  ) %>%
    rename(
      `2006` = "2006_2",
      `2007` = "2007_2",
      `2008` = "2008_2",
      `2009` = "2009_2",
      `2010` = "2010_2",
      `2011` = "2011_2",
      `2012` = "2012_2",
      `2013` = "2013_2",
      `2014` = "2014_2",
      `2015` = "2015_2",
      `2016` = "2016_2",
      `2017` = "2017_2",
      `2018` = "2018_2",
      `2019` = "2019_2",
      `2020` = "2020_2"
    )  %>% 
    pivot_longer(
      cols = c(2:16), 
      names_to = "Year",
      values_to = "Total"
    ) %>% 
  mutate(Year = as.numeric(Year)) # Set as numeric 
  
years_impl <- data.frame(Country = # Create a data frame with the years of implementation of infrastructures
                           c("Afghanistan", 
                             "Cambodia", 
                             "Colombia", 
                             "Costa Rica", 
                             "Ghana", 
                             "Kenya", 
                             "Yemen"
                           ), 
                         years = 
                           c(2010, 
                             2009,
                             2009, 
                             2016, 
                             2011, 
                             2008, 
                             2011)
                          )  

p <- ggplot(fsi_selection, aes(x = Year, y = Total, group = 1)) + 
    geom_line() +
    facet_wrap(~Country, 
               scales = "free_x") +
    labs(title="Fragile States Index Variation 2006 - 2020 (2006 score: 100)", 
         x = "Year", 
         y = "Total score") + 
    scale_x_continuous(breaks = c(2006, 2009,2012, 2015, 2018)) 

p + geom_vline(data = years_impl, mapping = aes(xintercept = years)) # Add line of when the infrastructure took place
  
```



## Session info

```{r}
devtools::session_info()
```


