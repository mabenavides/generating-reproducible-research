---
title: "Effects of infrastructures for peace"
author: "Maria Benavides"
output: github_document
---


```{r setup, include = FALSE}
library(tidyverse)
library(readxl)
library(here)
```


```{r import data, include = FALSE}

# Import FSI downloaded from the website 
fsi_all <- read_excel(here("data/fsi-2006.xlsx"))

for (i in 2007:2020) {           # Use for loop to import all files at once
  fsi_year <- read_excel(here(
    paste(
      "data/fsi-", i, ".xlsx", sep = "")
    )
  )
  if (i %in% c(2019,2020)) {
    fsi_year <- select(fsi_year, -"Change from Previous Year") # Drop extra column for 2019 and 2020
  }
  fsi_all <- rbind(fsi_all, fsi_year) # Combine all data frames into one
}

fsi_all$Year <- as.numeric(str_extract(fsi_all$Year, "[0-9]{4}")) # Modify year variable since it was on a date format 

# Import GPI also downloaded from the website 
gpi_all <- read_xlsx("data/GPI_all.xlsx", sheet = "Overall Scores", skip = 3)

```

## Introduction 

Achieving sustainable peace is one of the most relevant global issues today, especially, since high levels of conflict and violence appeared to be correlated with stagnant development; however, managing to transform violent conflict into stable, nonviolent social and political relationships is a great challenge. 

Recently, a new tool for peacebuilding has caught the attention of scholars and practitioners: *Infrastructures for Peace* (I4P). These can be understood as a dynamic network of skills, capacities, resources, tools and institutions that help build constructive relationships and enhance sustainable resilience of societies against the risks of relapse into violence (Giessmann, 2016).

Considering the above, on this report, I will explore the variations on some positive and negative peace indicators (Fragile State Index and Global Peace Index), on seven countries that have developed government-lead, national peace infrastructures. 

The countries are: 

* Afghanistan
* Cambodia
* Colombia
* Costa Rica
* Ghana
* Kenya
* Yemen

```{r data viz fsi, echo=FALSE}

# Plot a graph of the trends of FSI 

fsi_selection <- fsi_all %>%
  select(1,2,4) %>% # Select variables of interest
  filter(
      Country == "Colombia" |
      Country == "Afghanistan" |
      Country == "Cambodia" |
      Country == "Costa Rica" |
      Country == "Ghana" |
      Country == "Kenya" |
      Country == "Yemen" 
    ) %>%
    pivot_wider(
      id_cols = Country,
      names_from = Year, 
      values_from = Total
    ) %>%
    pivot_longer(
      cols = c(2:16), 
      names_to = "Year",
      values_to = "Total"
    ) %>% 
  mutate(Year = as.numeric(Year)) # Set as numeric 
  
years_impl <- data.frame(Country = # Create a data frame with the years of implementation of infrastructures
                           c("Afghanistan", 
                             "Cambodia", 
                             "Colombia", 
                             "Costa Rica", 
                             "Ghana", 
                             "Kenya", 
                             "Yemen"
                           ), 
                         years = 
                           c(2010, 
                             2009,
                             2016, 
                             2009, 
                             2011, 
                             2008, 
                             2011)
                          )  

p <- ggplot(fsi_selection, aes(x = Year, y = Total, group = 1)) + 
    geom_line() +
    facet_wrap(~Country, 
               scales = "free_x") +
    labs(title="Fragile States Index Variation 2006 - 2020 (2006 score: 100)", 
         x = "Year", 
         y = "Total score") + 
    scale_x_continuous(breaks = c(2006, 2009,2012, 2015, 2018)) 

p + geom_vline(data = years_impl, mapping = aes(xintercept = years)) # Add line of when the infrastructure took place
  
```

These countries adopted at least one of the following infrastructures: national peace councils, government departments, or peace ministries, policy and legislative measures creating I4P, or transitional justice mechanisms. If they were to be effective, we should see an improvement in the *Fragile State Index* overall score in the subsequent years to the implementation; nonetheless, as we can see on the graph, this is not the case for most countries. 

**(Take into consideration that a higher score, means worse conditions).**

Only Colombia and Costa Rica seemed to have improve in terms of state fragility in the years after the implementation of peace infrastructures. The *Yemen* case is also worth mentioning; it presents a drastic worsening overtime, even after the adoption of peace measures.

```{r data viz gpi, echo=FALSE}

# Plot a graph of the trends of GPI

gpi_selection <- gpi_all %>%
  select(-2) %>%   
  filter( # Filter selected countries 
      Country == "Colombia" |
      Country == "Afghanistan" |
      Country == "Cambodia" |
      Country == "Costa Rica" |
      Country == "Ghana" |
      Country == "Kenya" |
      Country == "Yemen" 
    ) %>%
    pivot_longer(
      cols = 2:13,
      names_to = "Year",
      values_to = "Score"
    ) %>%
  mutate(Year = as.numeric(Year)) # Set as numeric 

p <- ggplot(gpi_selection, aes(x = Year, y = Score, group = 1)) + 
    geom_line() +
    facet_wrap(~Country, 
               scales = "free_x") +
    labs(title="Global Peace Index 2008 - 2019", 
         x = "Year", 
         y = "Total score") + 
    scale_x_continuous(breaks = c(2006, 2009,2012, 2015, 2018)) 

p + geom_vline(data = years_impl, mapping = aes(xintercept = years)) # Add line of when the infrastructure took place
  
```

When considering the Global Peace Index, peace infrastructures do not appear to be effective, yet again; there is little variation on the overall scores (as in the FSI case, a higher value represents less peacefulness) after the implementation of I4P. 

It is interesting how there is a high variance (`r var(gpi_selection$Score)`) among the GPI scores; countries like Costa Rica and Ghana are, according to this index, very peaceful, while Yemen and Afghanistan are incredible violent. 


## Session info

```{r}
devtools::session_info()
```


